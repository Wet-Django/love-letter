		<script>
		// Restore music playlist and currentTrack for music player
		const musicPlaylist = [
			"./SpotiDown.App - Just the Way You Are - Bruno Mars.mp3",
			"./SpotiDown.App - Just the Two of Us - Bill Withers.mp3",
			"./SpotiDown.App - Love - Keyshia Cole.mp3"
		];
		let currentTrack = 0;
		</script>
<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>For My Fiancée — A Love Letter</title>
		<!-- Cute heart favicon -->
		<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 29'%3E%3Cpath d='M23.6 0C20.9 0 18.5 1.4 16 3.8 13.5 1.4 11.1 0 8.4 0 3.8 0 0 3.8 0 8.4 0 18.3 16 29 16 29s16-10.7 16-20.6C32 3.8 28.2 0 23.6 0z' fill='%23ff6d96'/%3E%3C/svg%3E" />
		<!-- Handwritten & script fonts -->
		<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Satisfy&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg1: #fff6fa;
			--bg2: #ffeef6;
			--accent: #ffb6d5;
			--accent2: #ff6d96;
			--ink: #3b2f2f;
			--paper: #fff9f7;
			--soft: #fff0f6;
			--shadow: 0 8px 32px rgba(255,110,150,0.10);
		}
		html, body {
			height: 100%;
			margin: 0;
			padding: 0;
			font-family: 'Patrick Hand', 'Satisfy', cursive, Arial, sans-serif;
			background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
			min-height: 100vh;
			color: var(--ink);
			overflow-x: hidden;
		}
		body {
			display: flex;
			align-items: center;
			justify-content: center;
			min-height: 100vh;
			padding: 0;
			position: relative;
		}
		.container {
			width: 98vw;
			max-width: 500px;
			margin: 0 auto;
			position: relative;
			z-index: 1;
		}
		.love-card {
			background: var(--paper);
			border-radius: 28px;
			box-shadow: var(--shadow), 0 0 0 8px #ffe0ec;
			border: 2px solid var(--accent);
			padding: 36px 22px 24px 22px;
			position: relative;
			overflow: visible;
			z-index: 2;
			animation: cardGlow 4s ease-in-out infinite alternate;
		}
		@keyframes cardGlow {
			0% { box-shadow: 0 0 0 8px #ffe0ec, var(--shadow);}
			100% { box-shadow: 0 0 32px 16px #ffd1dc, var(--shadow);}
		}
		header {
			text-align: center;
			margin-bottom: 10px;
			z-index: 2;
			position: relative;
		}
		.title {
			font-family: 'Satisfy', 'Patrick Hand', cursive;
			font-size: 2.3em;
			color: var(--accent2);
			margin: 0 0 2px 0;
			letter-spacing: 2px;
			text-shadow: 0 2px 8px #ffd1dc;
		}
		.subtitle {
			font-size: 1.1em;
			color: #a86b7a;
			margin-bottom: 8px;
			font-family: 'Patrick Hand', cursive;
			letter-spacing: 1px;
		}
		.countdown, .together {
			margin: 0 auto 0 0;
			text-align: center;
			font-family: 'Patrick Hand', cursive;
			font-size: 1.1em;
			color: #a86b7a;
			background: #fff0f6;
			border-radius: 12px;
			padding: 7px 14px;
			display: inline-block;
			box-shadow: 0 1px 4px #ffd1dc;
			margin-top: 10px;
		}
		.countdown .time, .together .time {
			font-size: 1.2em;
			font-weight: 700;
			color: var(--accent2);
		}
				 .mail-envelope {
					 display: flex;
					 flex-direction: column;
					 align-items: center;
					 justify-content: center;
					 font-size: 3em;
					 cursor: pointer;
					 margin: 20px auto;
					 text-align: center;
					 color: var(--accent2);
					 transition: transform 0.2s;
				 }
				 .mail-envelope:hover { transform: scale(1.1); }
				 .envelope-text { font-size: 1em; margin-top: 6px; color: #a86b7a; }

						 .letter-popup {
							 display: none;
							 position: fixed;
							 top: 50%;
							 left: 50%;
							 transform: translate(-50%, -50%);
							 width: 96vw;
							 max-width: 540px;
							 max-height: 88vh;
							 min-height: 180px;
							 overflow-y: auto;
							 background: #fff8f1;
							 border: 2.5px solid var(--accent2);
							 border-radius: 22px;
							 padding: 32px 22px 32px 22px;
							 box-shadow: 0 8px 32px 0 rgba(255,110,150,0.18), 0 2px 32px #ffe0ec;
							 font-family: 'Patrick Hand', 'Satisfy', cursive;
							 line-height: 1.7;
							 color: #7a3b4e;
							 z-index: 200;
							 scrollbar-width: thin;
							 scrollbar-color: #ffd1dc #fff8f1;
						 }
						 .letter-popup::-webkit-scrollbar {
							 width: 8px;
							 background: #fff8f1;
						 }
						 .letter-popup::-webkit-scrollbar-thumb {
							 background: #ffd1dc;
							 border-radius: 8px;
						 }
				 .letter-popup .close-letter {
					 position: absolute;
					 top: 12px; right: 12px;
					 background: #ffe3ea;
					 border: none;
					 border-radius: 50%;
					 width: 36px; height: 36px;
					 cursor: pointer;
					 font-size: 1.5em;
					 line-height: 36px;
					 color: #ff6d96;
					 text-align: center;
					 font-family: 'Satisfy', 'Patrick Hand', cursive;
					 box-shadow: 0 2px 8px #ffd1dc;
					 transition: background 0.18s, color 0.18s, transform 0.13s;
				 }
				 .letter-popup .close-letter:hover {
					 background: #ffd1dc;
					 color: #fff0f6;
					 transform: scale(1.08) rotate(-10deg);
				 }
				 .letter-popup .letter-content {
					 font-size: 1em;
					 white-space: pre-wrap;
				 }
		.cute-words {
			font-size: 1.1em;
			color: var(--accent2);
			margin-bottom: 18px;
			text-align: center;
			font-family: 'Satisfy', 'Patrick Hand', cursive;
			text-shadow: 0 1px 0 #fff, 0 2px 8px #ffd1dc;
			letter-spacing: 1px;
			animation: fadeIn 2s;
		}
		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(20px);}
			to { opacity: 1; transform: translateY(0);}
		}
		.controls {
			display: flex;
			justify-content: center;
			gap: 18px;
			margin: 18px 0 0 0;
			z-index: 2;
			position: relative;
			flex-wrap: wrap;
		}
			.controls label, .controls button {
				font-family: inherit;
				font-size: 1.08em;
				background: linear-gradient(180deg, #fff0f6 60%, #ffd1dc 100%);
				border: 2px solid #ffd1dc;
				border-radius: 22px;
				padding: 12px 22px;
				color: var(--accent2);
				cursor: pointer;
				box-shadow: 0 4px 16px #ffe0ec, 0 1.5px 0 #fff inset;
				transition: background 0.18s, color 0.18s, box-shadow 0.18s, transform 0.12s;
				outline: none;
				margin-bottom: 8px;
				font-weight: 600;
				letter-spacing: 0.5px;
				touch-action: manipulation;
			}
			.controls label:active, .controls button:active {
				transform: scale(0.97);
				box-shadow: 0 2px 8px #ffd1dc;
			}
			.controls label:hover, .controls button:hover {
				background: linear-gradient(180deg, #ffd1dc 60%, #fff0f6 100%);
				color: #fff;
			}
		.controls input[type="checkbox"] {
			accent-color: var(--accent2);
			margin-right: 7px;
			vertical-align: middle;
		}
			.surprise-btn {
				display: block;
				margin: 28px auto 0 auto;
				font-family: 'Satisfy', 'Patrick Hand', cursive;
				font-size: 1.22em;
				background: linear-gradient(90deg, var(--accent2) 60%, var(--accent) 100%);
				color: #fff;
				border: none;
				border-radius: 28px;
				padding: 16px 38px;
				box-shadow: 0 6px 24px #ffd1dc, 0 2px 0 #fff inset;
				cursor: pointer;
				transition: background 0.18s, transform 0.13s, box-shadow 0.18s;
				outline: none;
				letter-spacing: 1.2px;
				position: relative;
				z-index: 2;
				font-weight: 700;
				touch-action: manipulation;
			}
			.surprise-btn:active {
				transform: scale(0.97);
				box-shadow: 0 2px 8px #ffd1dc;
			}
			.surprise-btn:hover {
				background: linear-gradient(90deg, var(--accent) 60%, var(--accent2) 100%);
				color: #fff;
			}
		.surprise-message {
			display: none;
			margin: 24px auto 0 auto;
			background: linear-gradient(180deg, #fffaf6 0%, #fff5f2 100%);
			border-radius: 18px;
			padding: 22px 18px 18px 18px;
			border: 1.5px dashed #ffd1dc;
			box-shadow: 0 2px 12px #ffe0ec;
			font-size: 1.15em;
			color: #a86b7a;
			text-align: center;
			font-family: 'Satisfy', 'Patrick Hand', cursive;
			animation: fadeIn 1.2s;
			position: relative;
			z-index: 3;
		}
		.surprise-message.active {
			display: block;
			animation: fadeIn 1.2s;
		}
		.floating-hearts {
			pointer-events: none;
			position: absolute;
			left: 0; top: 0; width: 100%; height: auto;
			z-index: 3;
			overflow: visible;
		}
		.floating-heart {
			position: absolute;
			opacity: 0.5;
			animation: floatHeart 8s linear forwards;
			will-change: transform, opacity;
			pointer-events: none;
		}
		@keyframes floatHeart {
			0% { transform: translateY(100vh) scale(0.7) rotate(-20deg); opacity: 0;}
			10% { opacity: 0.8;}
			80% { opacity: 0.8;}
			100% { transform: translateY(-10vh) scale(1.2) rotate(20deg); opacity: 0;}
		}
		.confetti-canvas {
			position: absolute;
			left: 0; top: 0;
			pointer-events: none;
			width: 100%;
			height: 100%;
			z-index: 10;
		}
		footer {
			margin-top: 18px;
			font-size: 1em;
			color: #a86b7a;
			text-align: center;
			font-family: 'Satisfy', 'Patrick Hand', cursive;
			letter-spacing: 1px;
			opacity: 0.8;
		}
				@media (max-width: 900px) {
					.container { max-width: 98vw; }
					.love-card { padding: 18px 2vw 14px 2vw; border-radius: 20px; }
					.title { font-size: 2em; }
					.subtitle { font-size: 1em; }
					.poem-area { min-height: 100px; }
					.poem { font-size: 1.05em; }
					.cute-words { font-size: 1em; }
					.controls label, .controls button, .surprise-btn { font-size: 1.08em; padding: 12px 0; border-radius: 20px; }
					.surprise-message { font-size: 1em; padding: 14px 8px 12px 8px; border-radius: 14px; }
				}
				@media (max-width: 600px) {
					.container { max-width: 100vw; }
					.love-card { padding: 10px 2vw 10px 2vw; border-radius: 14px; box-shadow: 0 2px 12px #ffd1dc, 0 0 0 4px #ffe0ec; }
					.title { font-size: 1.3em; }
					.subtitle { font-size: 0.95em; }
					.poem-area { min-height: 60px; }
					.poem { font-size: 0.98em; padding: 0 2px; }
					.cute-words { font-size: 0.98em; }
					.controls { flex-direction: column; gap: 8px; }
					.controls label, .controls button, .surprise-btn { font-size: 1.1em; padding: 16px 0; width: 100%; border-radius: 22px; margin-bottom: 10px; }
					.surprise-message { font-size: 0.98em; padding: 10px 4px 8px 4px; border-radius: 10px; }
					.countdown, .together { font-size: 0.98em; padding: 6px 6px; border-radius: 8px; }
					footer { font-size: 0.95em; }
				}
				@media (max-width: 400px) {
					.love-card { padding: 4px 1vw 4px 1vw; border-radius: 8px; }
					.title { font-size: 1em; }
					.subtitle { font-size: 0.85em; }
					.poem { font-size: 0.9em; }
					.controls label, .controls button, .surprise-btn { font-size: 1em; padding: 12px 0; border-radius: 14px; }
					.surprise-message { font-size: 0.9em; padding: 6px 2px 6px 2px; border-radius: 7px; }
					.countdown, .together { font-size: 0.9em; padding: 4px 2px; border-radius: 6px; }
					footer { font-size: 0.9em; }
				}
	</style>
</head>
<body>
	<div class="container">
		<div class="love-card" role="main" aria-label="Love letter for my fiancée">
			<canvas class="confetti-canvas" id="confettiCanvas"></canvas>
			<div class="floating-hearts" id="heartsBg" aria-hidden="true"></div>
			<header>
				<div>
					<h1 class="title">For My Dearest</h1>
					<div class="subtitle">A letter from my heart, just for Hiba</div>
				</div>
				<div class="countdown" id="countdown" aria-live="polite">
					<div>Countdown to our forever:</div>
					<div class="time" id="timeDigits">loading...</div>
				</div>
				<div class="together" id="together" aria-live="polite" style="margin-top:10px;">
					<div>Time together:</div>
					<div class="time" id="togetherDigits">loading...</div>
				</div>
			</header>
			<div class="controls">
						<label>
							<input type="checkbox" id="musicToggle" />
							Music
						</label>
						<button id="shuffleMusicBtn" type="button" title="Shuffle Music" aria-label="Shuffle Music">🔀</button>
						<button id="toggleHeartsBtn" type="button">Hide Hearts</button>
			</div>
						 <div class="mail-envelope" id="mailEnvelope" role="button" aria-label="Click to open love letter">
							 💌
							 <div class="envelope-text">Click to open your letter</div>
						 </div>
						 <div class="letter-popup" id="letterPopup" aria-label="Your love letter">
									 <button class="close-letter" id="closeLetter" aria-label="Close letter">
										 <svg class="close-x-svg" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
											 <line x1="5" y1="5" x2="17" y2="17" stroke="#ff6d96" stroke-width="2.5" stroke-linecap="round"/>
											 <line x1="17" y1="5" x2="5" y2="17" stroke="#ff6d96" stroke-width="2.5" stroke-linecap="round"/>
										 </svg>
									 </button>
		<style>
		.close-x-svg {
			display: block;
			margin: 0 auto;
			pointer-events: none;
			filter: drop-shadow(0 1px 2px #ffd1dc);
			transition: stroke 0.18s;
		}
		.close-letter:hover .close-x-svg line {
			stroke: #fff0f6;
		}
		</style>
							 <div class="letter-content">
<div class="letter-title">hey my sweet hiba 💖</div>
i just wanna tell u how much u mean to me 😘 u’re my little princess, my sunshine, my everything. every time i see u laugh, every joke u tell, every story u share, i just… i melt. u’re so cute, so talented, so smart, and ur beautiful eyes… omg they just make me feel like everything in the world is perfect when i look at u 💕 u always know how to cheer me up when i’m down, u always find me when i need u, and u encourage me to be the best version of myself. u have this amazing way of making me feel loved and safe without even trying. ur courage, ur kindness, ur support… i can’t even explain how much that means to me. i honestly don’t know what i’d do without u, hiba 💖 every little thing about u makes me fall more in love. how u care, how u smile, how u dream, how u just exist in this world in the most perfect way. u make every day better, even when we’re far away. i love how u believe in me, how u push me to keep going, and how u make me feel like i can do anything with u by my side. u’re not just my girl… u’re my best friend, my little princess, my everything. i can’t wait for the day when i finally call u my wife 💍 i wanna wake up next to u, make every day special with u, and build our dreams together. i think about that day all the time and it makes me so happy. i’m ready to ask u the most important question of my life soon: will u be my wife? ❤️ this page is just a little piece of my heart for u — floating hearts, music, and a cute little surprise are all here to show u how much i love u 💌 i want u to feel my love every time u open it, to smile when u see it, and to know how much u mean to me, always. i’ll always care for u, protect u, and love u no matter what. u’re my dream, my joy, my little princess, and i’ll always be here for u 💖 forever yours, oussama 💕
		<style>
		.letter-title {
			font-family: 'Satisfy', 'Patrick Hand', cursive;
			font-size: 2em;
			color: #ff6d96;
			text-align: center;
			margin-bottom: 18px;
			margin-top: 2px;
			letter-spacing: 1.5px;
			text-shadow: 0 2px 8px #ffd1dc, 0 1px 0 #fff;
		}
		</style>
	<script>
	// Restore proposalDate and togetherSince for countdown/together
	const proposalDate = new Date('2025-11-31T00:00:00');
	const togetherSince = new Date('2025-09-05T00:00:00');
	</script>
							 </div>
						 </div>
			<button class="surprise-btn" id="surpriseBtn" aria-controls="surpriseMsg" aria-expanded="false">
				Press me for a surprise 💌
			</button>
			<div class="surprise-message" id="surpriseMsg" aria-label="Surprise message"></div>
			<div id="answerBtns" style="display:none; margin-top:18px; text-align:center;"></div>
			<footer>
				i ❤️ you, always and forever — Oussama <br>
				love keep checking the link for new letters😉
			</footer>
		</div>
	</div>
	<audio id="bgAudio" src="" preload="auto" loop></audio>
	<script>

			 // --- Letter Envelope Modal Logic ---
			 const mailEnvelope = document.getElementById('mailEnvelope');
			 const letterPopup = document.getElementById('letterPopup');
			 const closeLetter = document.getElementById('closeLetter');

			 mailEnvelope.addEventListener('click', () => {
				 letterPopup.style.display = 'block';
			 });

			 closeLetter.addEventListener('click', () => {
				 letterPopup.style.display = 'none';
			 });

		// --- Countdown Timer ---
		const timeEl = document.getElementById('timeDigits');
			function updateCountdown(){
				const now = new Date();
				let diff = proposalDate - now;
				if (diff < 0) {
					// Show a cute message when countdown is over
					timeEl.innerHTML = "<span style='font-size:1.2em;color:#ff6d96;'>Today is our forever! 💍💖<br>Let the magic begin!</span>";
					return;
				}
				const days = Math.floor(diff / (1000*60*60*24));
				diff -= days*1000*60*60*24;
				const hrs = Math.floor(diff / (1000*60*60));
				diff -= hrs*1000*60*60;
				const mins = Math.floor(diff / (1000*60));
				diff -= mins*1000*60;
				const secs = Math.floor(diff / 1000);
				timeEl.textContent = `${days}d ${String(hrs).padStart(2,'0')}h ${String(mins).padStart(2,'0')}m ${String(secs).padStart(2,'0')}s`;
			}
			updateCountdown();
			setInterval(updateCountdown,1000);

		// --- Time Together ---
		const togetherEl = document.getElementById('togetherDigits');
		function updateTogether(){
			const now = new Date();
			let diff = now - togetherSince;
			if (diff < 0) {
				togetherEl.textContent = "0d 00h 00m 00s";
				return;
			}
			const days = Math.floor(diff / (1000*60*60*24));
			diff -= days*1000*60*60*24;
			const hrs = Math.floor(diff / (1000*60*60));
			diff -= hrs*1000*60*60;
			const mins = Math.floor(diff / (1000*60));
			diff -= mins*1000*60;
			const secs = Math.floor(diff / 1000);
			togetherEl.textContent = `${days}d ${String(hrs).padStart(2,'0')}h ${String(mins).padStart(2,'0')}m ${String(secs).padStart(2,'0')}s`;
		}
		updateTogether();
		setInterval(updateTogether,1000);

				// --- Music Toggle & Shuffle Logic ---
				const audio = document.getElementById('bgAudio');
				const musicToggle = document.getElementById('musicToggle');
				const shuffleMusicBtn = document.getElementById('shuffleMusicBtn');
				function setMusic(trackIdx) {
					audio.src = musicPlaylist[trackIdx];
					if (musicToggle.checked) {
						audio.play().catch(()=>{});
					} else {
						audio.pause();
						audio.currentTime = 0;
					}
				}
				setMusic(currentTrack);
				musicToggle.addEventListener('change', function() {
					if (musicToggle.checked) {
						audio.play().catch(()=>{});
					} else {
						audio.pause();
						audio.currentTime = 0;
					}
				});
				shuffleMusicBtn.addEventListener('click', function() {
					currentTrack = (currentTrack + 1) % musicPlaylist.length;
					setMusic(currentTrack);
				});
				// Auto play next track when one ends
				audio.addEventListener('ended', function() {
					currentTrack = (currentTrack + 1) % musicPlaylist.length;
					setMusic(currentTrack);
				});

		// --- Floating Hearts Animation ---
		const heartsBg = document.getElementById('heartsBg');
		let heartsOn = true;
		function spawnFloatingHeart(x = null, y = null) {
			if (!heartsOn) return;
			const heart = document.createElement('div');
			heart.className = 'floating-heart';
			const size = Math.random() * 28 + 18;
			heart.style.width = size + 'px';
			heart.style.height = size + 'px';
			heart.style.left = x !== null ? `${x - size/2}px` : (Math.random() * 90) + '%';
			heart.style.bottom = y !== null ? `${window.innerHeight - y - size/2}px` : '-40px';
			heart.style.animationDuration = (7 + Math.random() * 4) + 's';
			heart.style.opacity = (Math.random() * 0.4 + 0.5).toFixed(2);
			heart.innerHTML = `<svg viewBox="0 0 32 29" width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
				<path d="M23.6 0C20.9 0 18.5 1.4 16 3.8 13.5 1.4 11.1 0 8.4 0 3.8 0 0 3.8 0 8.4 0 18.3 16 29 16 29s16-10.7 16-20.6C32 3.8 28.2 0 23.6 0z" fill="url(#g)"/>
				<defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#ff9bb1"/><stop offset="1" stop-color="#ff6d96"/></linearGradient></defs>
			</svg>`;
			heartsBg.appendChild(heart);
			setTimeout(()=>heart.remove(), 11000);
		}
		let heartInterval = setInterval(() => spawnFloatingHeart(), 700);

		// --- Hearts Show/Hide Logic ---
		const toggleHeartsBtn = document.getElementById('toggleHeartsBtn');
		toggleHeartsBtn.addEventListener('click', function() {
			heartsOn = !heartsOn;
			if (heartsOn) {
				heartInterval = setInterval(() => spawnFloatingHeart(), 700);
				heartsBg.style.opacity = "1";
				toggleHeartsBtn.textContent = "Hide Hearts";
			} else {
				clearInterval(heartInterval);
				heartsBg.style.opacity = "0.08";
				toggleHeartsBtn.textContent = "Show Hearts";
			}
		});

		// --- Tap/Click to Generate Little Hearts ---
		document.querySelector('.love-card').addEventListener('click', function(e) {
			// Only spawn if not clicking a button or input
			if (e.target.closest('button, input, label')) return;
			spawnFloatingHeart(e.clientX, e.clientY);
		});

		// --- Surprise Button Logic ---
			const surpriseBtn = document.getElementById('surpriseBtn');
			const surpriseMsg = document.getElementById('surpriseMsg');
			const answerBtns = document.getElementById('answerBtns');
			let surpriseShown = false;
			let runawayTries = 0;
			function showAnswerButtons() {
				answerBtns.innerHTML = `
					<button id="yesBtn" style="font-family:'Satisfy','Patrick Hand',cursive;font-size:1.1em;background:linear-gradient(90deg,#ffb6d5,#ff6d96);color:#fff;border:none;border-radius:16px;padding:10px 28px;margin:8px 12px;cursor:pointer;box-shadow:0 2px 8px #ffd1dc;transition:background 0.2s,transform 0.15s;">Yes 💖</button>
					<button id="noBtn" style="font-family:'Satisfy','Patrick Hand',cursive;font-size:1.1em;background:#fff0f6;color:#ff6d96;border:1.5px solid #ffd1dc;border-radius:16px;padding:10px 28px;margin:8px 12px;cursor:pointer;box-shadow:0 2px 8px #ffd1dc;position:relative;">No 🙈</button>
				`;
				answerBtns.style.display = 'block';
				const yesBtn = document.getElementById('yesBtn');
				const noBtn = document.getElementById('noBtn');
				// No button runs away
				function moveNoBtn(e) {
					const parent = answerBtns;
					const maxX = parent.offsetWidth - noBtn.offsetWidth - 10;
					const maxY = 30;
					const x = Math.random() * maxX;
					const y = Math.random() * maxY;
					noBtn.style.position = 'relative';
					noBtn.style.left = x + 'px';
					noBtn.style.top = y + 'px';
					runawayTries++;
					if(runawayTries > 6) noBtn.textContent = "Nope! 😜";
				}
				noBtn.addEventListener('mouseenter', moveNoBtn);
				noBtn.addEventListener('click', moveNoBtn);
				// Yes button triggers celebration
				yesBtn.addEventListener('click', function() {
					answerBtns.style.display = 'none';
					surpriseMsg.innerHTML = '<span style="font-size:2em;">💏</span><br><span style="font-size:1.2em;">Yaaay! You said Yes!<br>Let\'s celebrate our love! 💖</span>';
					launchConfetti();
					for(let i=0;i<10;i++) setTimeout(()=>spawnFloatingHeart(),i*120);
				});
			}
			surpriseBtn.addEventListener('click', function() {
				if (!surpriseShown) {
					// Show message
					const msg = surpriseMessages[Math.floor(Math.random() * surpriseMessages.length)];
					surpriseMsg.textContent = msg;
					surpriseMsg.classList.add('active');
					surpriseBtn.setAttribute('aria-expanded', 'true');
					// Confetti
					launchConfetti();
					// Music (if not already playing)
					if (!musicToggle.checked) {
						musicToggle.checked = true;
						audio.play().catch(()=>{});
					}
					// If it's the proposal message, show answer buttons
					if (msg.startsWith('Will you marry me')) {
						setTimeout(showAnswerButtons, 400);
					} else {
						answerBtns.style.display = 'none';
					}
					surpriseShown = true;
				} else {
					// Hide message and buttons
					surpriseMsg.classList.remove('active');
					answerBtns.style.display = 'none';
					surpriseBtn.setAttribute('aria-expanded', 'false');
					surpriseShown = false;
				}
			});

		// --- Confetti Effect ---
		const canvas = document.getElementById('confettiCanvas');
		const ctx = canvas.getContext('2d');
		let particles = [];
		function resizeCanvas(){ canvas.width = canvas.clientWidth; canvas.height = canvas.clientHeight; }
		window.addEventListener('resize', resizeCanvas);
		resizeCanvas();

		function random(min,max){ return Math.random()*(max-min)+min; }
		function launchConfetti(){
			const count = 80;
			particles = [];
			for(let i=0;i<count;i++){
				particles.push({
					x: random(0, canvas.width),
					y: random(canvas.height*0.4, canvas.height*0.9),
					vx: random(-6,6),
					vy: random(-12,-4),
					size: random(6,14),
					rot: random(0,Math.PI*2),
					color: ['#ff6d96','#ffd1dc','#ffc8e0','#ffd59e'][Math.floor(random(0,4))],
					life: random(60,120)
				});
			}
			animateConfetti();
		}

		let confettiAnim;
		function animateConfetti(){
			cancelAnimationFrame(confettiAnim);
			function step(){
				ctx.clearRect(0,0,canvas.width,canvas.height);
				particles.forEach((p,idx)=>{
					p.x += p.vx;
					p.y += p.vy;
					p.vy += 0.35; 
					p.rot += 0.15;
					p.life--;
					ctx.save();
					ctx.translate(p.x,p.y);
					ctx.rotate(p.rot);
					ctx.fillStyle = p.color;
					ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
					ctx.restore();
				});
				particles = particles.filter(p=>p.life>0 && p.y < canvas.height + 50);
				if (particles.length>0) confettiAnim = requestAnimationFrame(step);
			}
			step();
		}
	</script>
</body>
</html>
